\usepackage{tikz}
\usepackage{circuitikz}

% ---------------
% Example IC
% ---------------
\pgfdeclareshape{ic8pin}{
\anchor{center}{\pgfpointorigin} % (0,0) is the center

\anchor{text}
{\pgfpoint{-0.5\wd\pgfnodeparttextbox}{-.5\ht\pgfnodeparttextbox}}

\savedanchor\icpina{\pgfpoint{-.75cm}{-.625cm}}
\anchor{p1}{\icpina}
\savedanchor\icpinb{\pgfpoint{-.25cm}{-.625cm}} % pin 2
\anchor{p2}{\icpinb}
\savedanchor\icpinc{\pgfpoint{.25cm}{-.625cm}} % pin 3
\anchor{p3}{\icpinc}
\savedanchor\icpind{\pgfpoint{.75cm}{-.625cm}} % pin 4
\anchor{p4}{\icpind}
\savedanchor\icpine{\pgfpoint{.75cm}{.625cm}} % pin 5
\anchor{p5}{\icpine}
\savedanchor\icpinf{\pgfpoint{.25cm}{.625cm}} % pin 6
\anchor{p6}{\icpinf}
\savedanchor\icping{\pgfpoint{-.25cm}{.625cm}} % pin 7
\anchor{p7}{\icping}
\savedanchor\icpinh{\pgfpoint{-.75cm}{.625cm}} % pin 8
\anchor{p8}{\icpinh}


\foregroundpath{ % border and pin numbers are drawn here
\pgfsetlinewidth{0.05cm}
\pgfpathrectanglecorners{\pgfpoint{1cm}{.625cm}}{\pgfpoint{-1cm}{-.625cm}}
\pgfusepath{draw} %draw rectangle
\pgfsetlinewidth{0.03cm}
\pgfpathmoveto{\pgfpoint{-1cm}{-.3cm}}
\pgfpatharc{-90}{90}{.3cm}
\pgfusepath{draw} %draw semicircle
\pgftext[bottom,at={\pgfpoint{-.75cm}{-.55cm}}]{\scriptsize 1}
\pgftext[bottom,at={\pgfpoint{-.25cm}{-.55cm}}]{\scriptsize 2}
\pgftext[bottom,at={\pgfpoint{.25cm}{-.55cm}}]{\scriptsize 3}
\pgftext[bottom,at={\pgfpoint{.75cm}{-.55cm}}]{\scriptsize 4}
\pgftext[top,at={\pgfpoint{.75cm}{.55cm}}]{\scriptsize 5}
\pgftext[top,at={\pgfpoint{.25cm}{.55cm}}]{\scriptsize 6}
\pgftext[top,at={\pgfpoint{-.25cm}{.55cm}}]{\scriptsize 7}
\pgftext[top,at={\pgfpoint{-.75cm}{.55cm}}]{\scriptsize 8}
}}

% ---------------
% D FlipFlop
% ---------------
\pgfpoint{-.625cm}{.6cm}
\pgfgetlastxy{\xd}{\yd}
\pgfpoint{-.625cm}{-.6cm}
\pgfgetlastxy{\xc}{\yc}
\pgfpoint{.625cm}{.6cm}
\pgfgetlastxy{\xq}{\yq}
\pgfpoint{.625cm}{-.6cm}
\pgfgetlastxy{\xqn}{\yqn}
\pgfpoint{-.625cm}{-1cm}
\pgfgetlastxy{\xsw}{\ysw}
\pgfpoint{.625cm}{1cm}
\pgfgetlastxy{\xne}{\yne}

\pgfdeclareshape{dff}{
\anchor{center}{\pgfpointorigin}

\savedanchor\pind{\pgfpoint{\xd}{\yd}}
\anchor{d}{\pind}
\savedanchor\pinc{\pgfpoint{\xc}{\yc}}
\anchor{c}{\pinc}
\savedanchor\pinq{\pgfpoint{\xq}{\yq}}
\anchor{q}{\pinq}
\savedanchor\pinnq{\pgfpoint{\xqn}{\yqn}}
\anchor{nq}{\pinnq}

\foregroundpath{
\pgfsetlinewidth{0.05cm}
\pgfpathrectanglecorners{\pgfpoint{-.625cm}{-1cm}}{\pgfpoint{.625cm}{1cm}}
\pgfusepath{draw}
\pgftext[left,at={\pgfpoint{-.55cm}{.6cm}}]{\scriptsize $D$}
\pgftext[left,at={\pgfpoint{-.55cm}{-.6cm}}]{\scriptsize $C$}
\pgftext[right,at={\pgfpoint{.55cm}{.6cm}}]{\scriptsize $Q$}
\pgftext[right,at={\pgfpoint{.55cm}{-.6cm}}]{\scriptsize $\overline{Q}$}
}}
